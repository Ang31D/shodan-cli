[
  {
    "id": "shodan-http-products",
    "name": "shodan http products",
    "description": "match web products from shodan api host",
    "owner": {
      "researcher": "John Doe",
      "company": "Company X"
    },
    "enable_on": "_shodan,_shodan.module:begins=http",
    "conditions": [
      {
        "path": "_shodan",
        "compare": "!exists",
        "match_on": null,
        "loose_match": true,
        "_extended": null
      },
      {
        "path": null,
        "compare": null,
        "match_on": null,
        "loose_match": true,
        "_extended": "product,product:min-len=1"
      }
    ],
    "fields": [
      {
        "id": "shodan.id",
        "text": "\tShodan - ID",
        "path": "_shodan.id",
        "condition": "_shodan.id"
      },
      {
        "id": "host.ip",
        "path": "ip_str",
        "condition": ""
      },
      {
        "id": "host.service.port",
        "path": "port",
        "condition": ""
      },
      {
        "id": "host.port.protocol",
        "path": "transport",
        "condition": ""
      },
      {
        "id": "service.module",
        "path": "_shodan.module",
        "condition": "_shodan.module"
      },
      {
        "id": "product",
        "text": "\tProduct",
        "path": "product",
        "condition": "product:exists,product:min-len=1"
      },
      {
        "id": "http.server.header",
        "text": "\tProduct",
        "path": "http.server",
        "condition": "http.server,http.server:min-len=1"
      },
      {
        "id": "http.page.title",
        "text": "Page Title",
        "path": "http.title",
        "condition": "http.title:exists,http.title:min-len=1"
      },
      {
        "id": "http.host.header",
        "text": "\t'Host' Header",
        "path": "http.host",
        "condition": "_shodan,http.host:exists,http.host:min-len=1"
      },
      {
        "id": "product.cobalt_strike",
        "text": "\t'Host' Header",
        "path": "product",
        "condition": "product=Cobalt Strike Beacon"
      },
      {
        "id": "cobalt_strike.http-get.uri",
        "text": "\t'Host' Header",
        "path": "cobalt_strike_beacon.x86.http-get.uri",
        "condition": "cobalt_strike_beacon.x86.http-get.uri"
      }
    ],
    "templates": [
      {
        "id": "rule.header",
        "template_dependency": "",
        "field_requirement": "host.ip,host.service.port,host.port.protocol,service.module,shodan.id",
        "data": [
          "[field:host.ip]\t\t[field:host.service.port]/[field:host.port.protocol]\t\tHTTP-Service ([field:service.module]) # Shodan - ID: [field:shodan.id]\n"
        ]
      },
      {
        "id": "http.product",
        "template_dependency": "rule.header",
        "field_requirement": "product,http.server.header",
        "data": [
          "\tproduct: [field:product], 'server' header: [field:http.server.header]"
        ]
      },
      {
        "id": "product.server.header",
        "template_dependency": "rule.header",
        "field_requirement": "host.ip,host.service.port'",
        "data": [
          "\tproduct: [field:product], 'server' header: [field:http.server.header]"
        ]
      },
      {
        "id": "product.host.header",
        "template_dependency": "rule.header",
        "field_requirement": "host.ip,host.service.port'",
        "data": [
          "\tproduct: [field:product], 'host' header: [field:http.host.header]"
        ]
      },
      {
        "id": "product.cobalt_strike",
        "template_dependency": "rule.header",
        "field_requirement": "product.cobalt_strike'",
        "data": [
          "\tproduct: [field:product], http-get.uri: '[cobalt_strike.http-get.uri]'"
        ]
      }
    ]
  }
]
